<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        
        <!-- Cron job to cancel expired Vipps payments -->
        <record id="ir_cron_cancel_expired_vipps_payments" model="ir.cron">
            <field name="name">Cancel Expired Vipps Payments</field>
            <field name="model_id" ref="payment.model_payment_transaction"/>
            <field name="state">code</field>
            <field name="code">model._cancel_expired_payments()</field>
            <field name="interval_number">5</field>
            <field name="interval_type">minutes</field>
            <field name="numbercall">-1</field>
            <field name="active">True</field>
            <field name="user_id" ref="base.user_root"/>
            <field name="doall">False</field>
        </record>

        <!-- Cron job to cleanup old webhook events (weekly) -->
        <record id="ir_cron_cleanup_webhook_events" model="ir.cron">
            <field name="name">Cleanup Old Vipps Webhook Events</field>
            <field name="model_id" ref="base.model_ir_config_parameter"/>
            <field name="state">code</field>
            <field name="code">
# Cleanup webhook events older than 30 days
from datetime import datetime, timedelta
import json

cutoff_time = datetime.now() - timedelta(days=30)
cutoff_timestamp = int(cutoff_time.timestamp())

# Find old webhook event parameters
old_events = env['ir.config_parameter'].search([
    ('key', 'like', 'vipps.webhook.event.%')
])

deleted_count = 0
for param in old_events:
    try:
        event_data = json.loads(param.value)
        processed_at = datetime.fromisoformat(event_data.get('processed_at', ''))
        if processed_at &lt; cutoff_time:
            param.unlink()
            deleted_count += 1
    except:
        # Delete malformed entries
        param.unlink()
        deleted_count += 1

if deleted_count > 0:
    env.cr.commit()
            </field>
            <field name="interval_number">1</field>
            <field name="interval_type">weeks</field>
            <field name="numbercall">-1</field>
            <field name="active">True</field>
            <field name="user_id" ref="base.user_root"/>
            <field name="doall">False</field>
        </record>

    </data>
</odoo>